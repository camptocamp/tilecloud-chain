Backport of #3029 to 1.23

Error on cherry-picking: 3a37b07da7a5e15f9fb2b674e2c87b7ad302e097

To continue do:
```bash
git fetch && \
  git checkout ghci/backport/3029-to-1.23 && \
  git reset --hard HEAD^ && \
  git cherry-pick 3a37b07da7a5e15f9fb2b674e2c87b7ad302e097
git push origin ghci/backport/3029-to-1.23 --force
```